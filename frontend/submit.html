<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Submit Service Request - CampusFix</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f3f4f6; margin: 0; }
    header { background: #2563eb; color: #fff; padding: 16px 24px; }
    main {
      max-width: 800px; margin: 40px auto; background: #fff;
      padding: 24px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    label { display: block; margin-top: 12px; }
    input, textarea, select {
      width: 100%; padding: 8px; margin-top: 4px;
      border: 1px solid #d1d5db; border-radius: 4px;
    }
    button {
      margin-top: 16px; padding: 10px 16px; border: none;
      background: #2563eb; color: #fff; border-radius: 4px; cursor: pointer;
    }
    .message { margin-top: 16px; }
  </style>
</head>
<body>
<header>
  <h1>CampusFix</h1>
</header>

<main>
  <h2>Submit a New Service Request</h2>

  <form id="requestForm">
    <label>
      Your Name
      <input type="text" name="name" required />
    </label>

    <label>
      Email
      <input type="email" name="email" required />
    </label>

    <label>
      Location (Room, Lab, Building)
      <input type="text" name="location" required />
    </label>

    <label>
      Category
      <select name="category" required>
        <option value="">-- Select --</option>
        <option value="IT">IT / Computer / Network</option>
        <option value="Classroom">Classroom Equipment</option>
        <option value="Lab">Lab Equipment</option>
        <option value="Facility">Facility / Maintenance</option>
        <option value="Other">Other</option>
      </select>
    </label>

    <label>
      Description
      <textarea name="description" rows="4" required></textarea>
    </label>

    <label>
      Attach Photo (optional)
      <input type="file" name="photo" accept="image/*" />
    </label>

    <button type="submit">Submit Request</button>
    <div class="message" id="message"></div>
  </form>

  <p><a href="index.html">← Back to Home</a></p>
</main>

<script>
  // TODO: replace this with your real API Gateway endpoint later
  const API_BASE_URL = "https://your-api-id.execute-api.region.amazonaws.com/prod";

  const form = document.getElementById("requestForm");
  const messageDiv = document.getElementById("message");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    messageDiv.textContent = "Submitting...";

    const formData = new FormData(form);

    // For now, ignore file upload – we will later use S3 presigned URL.
    const payload = {
      name: formData.get("name"),
      email: formData.get("email"),
      location: formData.get("location"),
      category: formData.get("category"),
      description: formData.get("description")
    };

    try {
      const res = await fetch(`${API_BASE_URL}/submit`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload)
      });

      const data = await res.json();
      if (res.ok) {
        messageDiv.textContent =
          `Request submitted! Your ID is: ${data.issueId}`;
        form.reset();
      } else {
        messageDiv.textContent = `Error: ${data.message || "Something went wrong"}`;
      }
    } catch (err) {
      console.error(err);
      messageDiv.textContent = "Network error. Please try again.";
    }
  });
</script>
</body>
</html>
